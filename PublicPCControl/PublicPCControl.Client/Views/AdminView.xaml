<!-- File: PublicPCControl.Client/Views/AdminView.xaml -->
<UserControl x:Class="PublicPCControl.Client.Views.AdminView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" Background="#0c111c">
    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <StackPanel Orientation="Vertical" Margin="0,0,0,14">
            <TextBlock Text="관리자 설정" Foreground="#eff4ff" FontSize="28" FontWeight="Bold" />
            <TextBlock Text="운영 옵션, 허용 프로그램, 관리자 도구를 한 곳에서 관리하세요." Foreground="#c4d2f1" />
        </StackPanel>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2.4*" />
                <ColumnDefinition Width="2.6*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <Border Grid.Row="0" Grid.Column="0" Background="#0f1728" Padding="16" CornerRadius="16" BorderBrush="#1d2a42" BorderThickness="1" Margin="0,0,10,10">
                <StackPanel>
                    <StackPanel.Resources>
                        <Style TargetType="TextBlock">
                            <Setter Property="Foreground" Value="#e2ebff" />
                            <Setter Property="FontSize" Value="15" />
                        </Style>
                        <Style TargetType="CheckBox">
                            <Setter Property="Foreground" Value="#e2ebff" />
                            <Setter Property="Margin" Value="0,6,0,0" />
                            <Setter Property="FontSize" Value="15" />
                        </Style>
                        <Style TargetType="RadioButton">
                            <Setter Property="Foreground" Value="#e2ebff" />
                            <Setter Property="Margin" Value="0,6,0,0" />
                            <Setter Property="FontSize" Value="15" />
                            <Setter Property="FontWeight" Value="SemiBold" />
                        </Style>
                        <Style TargetType="TextBox">
                            <Setter Property="Margin" Value="0,4,0,10" />
                            <Setter Property="Padding" Value="10" />
                            <Setter Property="FontSize" Value="15" />
                            <Setter Property="Background" Value="#0f192c" />
                            <Setter Property="Foreground" Value="#f7fbff" />
                            <Setter Property="BorderBrush" Value="#4f6fb5" />
                            <Setter Property="BorderThickness" Value="1.4" />
                        </Style>
                    </StackPanel.Resources>
                    <TextBlock Text="운영 설정" FontWeight="Bold" FontSize="18" />
                    <TextBlock Text="공용 PC 관리와 관리자 전용 PC 중 하나는 반드시 선택됩니다." Foreground="#9fd6ff" FontSize="13" />
                    <UniformGrid Columns="2" Margin="0,4,0,6">
                        <RadioButton GroupName="OperatingMode" Content="공용 PC 관리 기능 ON" IsChecked="{Binding EnforcementEnabled}" />
                        <RadioButton GroupName="OperatingMode" Content="관리자 전용 PC (관리자만 사용)" IsChecked="{Binding IsAdminOnlyPc}" />
                    </UniformGrid>
                    <CheckBox Content="허용되지 않은 프로그램 자동 종료" IsChecked="{Binding KillDisallowedProcess}" />
                    <Separator Margin="0,10,0,10" />
                    <TextBlock Text="기본 이용 시간 (분)" />
                    <TextBox Text="{Binding DefaultSessionMinutes}" />
                    <TextBlock Text="연장 설정" FontWeight="SemiBold" Margin="0,4,0,2" />
                    <StackPanel Orientation="Horizontal">
                        <StackPanel Width="140" Margin="0,0,10,0">
                            <TextBlock Text="회당 연장 (분)" />
                            <TextBox Text="{Binding SessionExtensionMinutes}" />
                        </StackPanel>
                        <StackPanel Width="140" Margin="0,0,10,0">
                            <TextBlock Text="연장 가능 횟수" />
                            <TextBox Text="{Binding MaxExtensionCount}" />
                        </StackPanel>
                        <StackPanel>
                            <TextBlock Text="연장 허용" />
                            <CheckBox IsChecked="{Binding AllowExtensions}" Content="사용" />
                        </StackPanel>
                    </StackPanel>
                    <Border Background="#0f1524" BorderBrush="#233555" BorderThickness="1" CornerRadius="12" Padding="12" Margin="0,10,0,0">
                        <TextBlock Text="관리자가 지정한 기본/연장 시간이 사용자 입력에 우선 적용됩니다." Foreground="#b7c8f1" TextWrapping="Wrap" />
                    </Border>
                </StackPanel>
            </Border>

            <Border Grid.Row="0" Grid.Column="1" Background="#0f1728" Padding="16" CornerRadius="16" BorderBrush="#1d2a42" BorderThickness="1" Margin="10,0,0,10">
                <StackPanel>
                    <StackPanel.Resources>
                        <Style TargetType="TextBlock">
                            <Setter Property="Foreground" Value="#e2ebff" />
                            <Setter Property="FontSize" Value="15" />
                        </Style>
                    </StackPanel.Resources>
                    <TextBlock Text="관리자 도구" FontWeight="Bold" FontSize="18" />
                    <Grid Margin="0,8,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Border Background="#122033" CornerRadius="12" Padding="12" BorderBrush="#203454" BorderThickness="1" Margin="0,0,10,0">
                            <StackPanel>
                                <TextBlock Text="관리자 모드" FontWeight="SemiBold" />
                                <TextBlock Text="운영을 잠시 중단하고 일반 PC처럼 사용 후 쉽게 복귀합니다." Foreground="#b7c8f1" TextWrapping="Wrap" />
                                <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                    <Button Content="운영 일시 중지" Command="{Binding EnterMaintenanceCommand}" Padding="12,8" Background="#3a547d" Foreground="#eaf1ff" Margin="0,0,8,0" />
                                    <Button Content="운영 재개" Command="{Binding ResumeFromMaintenanceCommand}" Padding="12,8" Background="#4fb36a" Foreground="#0c1b0d" />
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        <Border Background="#122033" CornerRadius="12" Padding="12" BorderBrush="#203454" BorderThickness="1">
                            <StackPanel>
                                <TextBlock Text="관리자 비밀번호" FontWeight="SemiBold" />
                                <TextBlock Text="비밀번호 변경 창을 통해 안전하게 갱신합니다." Foreground="#b7c8f1" TextWrapping="Wrap" />
                                <Button Content="비밀번호 변경" Padding="12,8" Margin="0,8,0,0" Background="#3a547d" Foreground="#eaf1ff" Click="OnChangePassword" />
                            </StackPanel>
                        </Border>
                    </Grid>
                </StackPanel>
            </Border>

            <Border Grid.Row="1" Grid.ColumnSpan="2" Background="#0f1728" Padding="16" CornerRadius="16" BorderBrush="#1d2a42" BorderThickness="1" Margin="0,10,0,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1.7*" />
                        <ColumnDefinition Width="1.3*" />
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Row="0" Grid.ColumnSpan="2" Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="허용 프로그램" FontWeight="Bold" FontSize="18" />
                        <TextBlock Text="추가/삭제 후 저장하면 바로 반영됩니다." Foreground="#b7c8f1" Margin="8,2,0,0" />
                        <StackPanel Orientation="Horizontal" Margin="16,0,0,0" VerticalAlignment="Center">
                            <StackPanel>
                                <TextBlock Text="이름/경로 검색" Foreground="#9fd6ff" FontSize="12" />
                                <Grid Width="260">
                                    <TextBox x:Name="ProgramSearchBox" Width="260" Text="{Binding ProgramSearchText, UpdateSourceTrigger=PropertyChanged}" Background="#0d1627" Foreground="#f6fbff" BorderBrush="#36548c" BorderThickness="1.2" Padding="10" ToolTip="이름 또는 경로로 허용 목록을 검색합니다." />
                                    <TextBlock Text="허용 목록에서 빠르게 찾기" Foreground="#5d76a5" Margin="12,0,0,0" VerticalAlignment="Center" IsHitTestVisible="False">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Text, ElementName=ProgramSearchBox}" Value="">
                                                        <Setter Property="Visibility" Value="Visible" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </Grid>
                            </StackPanel>
                            <Button Content="추천 프로그램 창 열기" Command="{Binding OpenSuggestionsCommand}" Padding="12,8" Background="#24375a" Foreground="#eaf1ff" Margin="10,12,0,0" />
                        </StackPanel>
                    </StackPanel>

                    <Grid Grid.Row="1" Grid.Column="0" Margin="0,12,10,0">
                        <Border Background="#10192c" BorderBrush="#213459" BorderThickness="1" CornerRadius="12">
                            <DataGrid x:Name="AllowedProgramsGrid" ItemsSource="{Binding AllowedProgramsView}" AutoGenerateColumns="False" HeadersVisibility="Column" Background="#0f1728" Foreground="#eaf1ff" BorderThickness="0" CanUserAddRows="False" RowBackground="#0f1728" AlternatingRowBackground="#101a2d" RowHeaderWidth="0" GridLinesVisibility="None">
                                <DataGrid.Resources>
                                    <SolidColorBrush x:Key="DataGrid.Row.MouseOver" Color="#1e2c45" />
                                    <SolidColorBrush x:Key="DataGrid.SelectionBrush" Color="#3e5f9e" />
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="Background" Value="#111b2d" />
                                        <Setter Property="Foreground" Value="#dfe9ff" />
                                        <Setter Property="FontWeight" Value="SemiBold" />
                                        <Setter Property="BorderBrush" Value="#1f2f4d" />
                                    </Style>
                                </DataGrid.Resources>
                                <DataGrid.CellStyle>
                                    <Style TargetType="DataGridCell">
                                        <Setter Property="Foreground" Value="#f2f6ff" />
                                        <Setter Property="FontSize" Value="14" />
                                        <Setter Property="Padding" Value="10,6" />
                                        <Setter Property="BorderThickness" Value="0" />
                                        <Setter Property="Background" Value="Transparent" />
                                    </Style>
                                </DataGrid.CellStyle>
                                <DataGrid.RowStyle>
                                    <Style TargetType="DataGridRow">
                                        <Setter Property="Foreground" Value="#eef4ff" />
                                        <Setter Property="FontSize" Value="14" />
                                        <Setter Property="Margin" Value="2" />
                                        <Setter Property="SnapsToDevicePixels" Value="True" />
                                    </Style>
                                </DataGrid.RowStyle>
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="이름" Binding="{Binding DisplayName}" Width="1.2*">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Foreground" Value="#f6fbff" />
                                                <Setter Property="TextWrapping" Value="Wrap" />
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="경로" Binding="{Binding ExecutablePath}" Width="2*">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Foreground" Value="#d1ddff" />
                                                <Setter Property="TextWrapping" Value="Wrap" />
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="인자" Binding="{Binding Arguments}" Width="*">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Foreground" Value="#f6fbff" />
                                                <Setter Property="TextWrapping" Value="Wrap" />
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Border>
                        <TextBlock Text="허용된 프로그램이 없습니다. 오른쪽에서 추가해 주세요." Foreground="#9fb4dd" FontSize="13" HorizontalAlignment="Center" VerticalAlignment="Center" TextAlignment="Center">
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding AllowedPrograms.Count}" Value="0">
                                            <Setter Property="Visibility" Value="Visible" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                    </Grid>

                    <StackPanel Grid.Row="1" Grid.Column="1" Margin="10,12,0,0">
                        <TextBlock Text="새 프로그램 추가" FontWeight="SemiBold" Foreground="#e2ebff" FontSize="16" />
                        <Border Background="#0e1727" BorderBrush="#233555" BorderThickness="1" CornerRadius="12" Padding="12" Margin="0,6,0,10">
                            <StackPanel>
                                <TextBlock Text="표시 이름" Foreground="#b7c8f1" />
                                <TextBox Text="{Binding NewProgramName}" Background="#0f192c" Foreground="#f6fbff" BorderBrush="#36548c" />
                                <TextBlock Text="실행 파일 경로" Foreground="#b7c8f1" />
                                <StackPanel Orientation="Horizontal">
                                    <TextBox Text="{Binding NewProgramPath}" Width="220" Background="#0f192c" Foreground="#f6fbff" BorderBrush="#36548c" />
                                    <Button Content="찾기" Width="70" Margin="8,0,0,0" Click="OnBrowseProgram" Background="#3a547d" Foreground="#eaf1ff" />
                                </StackPanel>
                                <TextBlock Text="실행 인자 (선택)" Foreground="#b7c8f1" />
                                <TextBox Text="{Binding NewProgramArguments}" Background="#0f192c" Foreground="#f6fbff" BorderBrush="#36548c" />
                                <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                    <Button Content="허용 목록에 추가" Command="{Binding AddProgramCommand}" Padding="12,8" Background="#4fb36a" Foreground="#0c1b0d" />
                                    <Button Content="선택 삭제" Command="{Binding RemoveProgramCommand}" Margin="8,0,0,0" Padding="12,8" CommandParameter="{Binding SelectedItem, ElementName=AllowedProgramsGrid}" Background="#2f3f5a" Foreground="#eaf1ff" />
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <TextBlock Text="추천 프로그램은 별도 창에서 검색/추가할 수 있습니다." FontWeight="SemiBold" Foreground="#e2ebff" FontSize="15" />
                        <Border Background="#0e1727" BorderBrush="#233555" BorderThickness="1" CornerRadius="12" Padding="12" Margin="0,6,0,0">
                            <TextBlock Text="'추천 프로그램 창 열기' 버튼을 눌러 시작 메뉴/바탕화면/설치 경로를 스캔한 결과를 확인하고, 바로 허용 목록에 추가하세요." Foreground="#9fb4dd" TextWrapping="Wrap" />
                        </Border>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>

        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,12,0,0">
            <Button Content="저장" Command="{Binding SaveCommand}" Margin="0,0,10,0" Padding="18,10" Background="#4fb36a" Foreground="#0c1b0d" FontWeight="Bold" />
            <Button Content="닫기" Command="{Binding CloseCommand}" Padding="16,10" Background="#1f2a3d" Foreground="#dfe8ff" />
        </StackPanel>
    </Grid>
</UserControl>
